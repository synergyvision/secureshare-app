<ion-view view-title="{{infoChat.title}}" ng-controller="chatsController" ng-init="chatInfo()" cache-view="false">
    <ion-header-bar class="bar-subheader" >

            <button class="button button-clear button-positive" ng-click="savePop()">{{'chats.see' | translate}}</button>
    </ion-header-bar>
    <ion-content ng-init="getMessages()">
    <div ng-repeat="message in chatMessages | orderBy: 'this.data.date_sent'" >
        <div class="card" id="sentMessage" ng-if="message.data.id_sender == uid">  
            <div class="item item-text-wrap" style="background-color: cornflowerblue;">
                    <p id="messageContent">
                        {{message.data.username}}<br>
                        <span ng-if="!message.decrypted">{{'chats.encrypted' | translate}}</span>
                        <span ng-if="message.decrypted">{{message.data.content}}</span>
                        <br>
                        <small id="data">{{message.sent}}</small>
                    </p>  
            </div>
        </div>
        <div class="card" id="receivedMessage" ng-if="message.data.id_sender != uid">
            <div class="item item-text-wrap">
                <p>
                    {{message.data.username}}<br>
                    <span ng-if="!message.decrypted">{{'chats.encrypted' | translate}}</span>
                    <span ng-if="message.decrypted">{{message.data.content}}</span>
                    <br>
                    <small id="data">{{message.sent}}</small>
                </p>    
            </div>
        </div>
    </div>    
    </ion-content>
    <ion-footer-bar align-title="left" class="bar-light" id="footer">
        <div class="bar bar-footer item-input-inset">
            <label class="item-input-wrapper">
            <input type="text" ng-model="chatMessage">
            </label>
            <button class="button button-small button-clear button-balanced" ng-click="sendToChat()">
                <i class="icon ion-android-send"></i>
            </button>
        </div>   
    </ion-footer-bar>
  </ion-view>
  